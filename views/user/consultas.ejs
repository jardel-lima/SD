<!DOCTYPE html>
<div ng-app="consultas"  ng-controller="consultasController">
	<div class="row">
		<div class="col-md-12">

			<div class="panel panel-primary" style =" margin: auto; border-color:green;">
			  <div class="panel-heading" style="background-color:green">Consultas</div>
			  <div class="panel-body">
			   		<table class= "table table-striped table-bordered table-hover">
							<thead>
								<th style='width:5%;'>N</th> <th style='width:30%;'>Paciente</th> <th style='width:25%;'>Data da Ãšltima Consulta</th> <th style='width:25%';>Data Nova Consulta</th> <th style='width:15%;'>Acompanhamento</th>     
							</thead>
							<tr ng-repeat = "consulta in consultaList">
								<td> {{consultaList.indexOf(consulta)}}</td>
								<td>{{consulta.paciente.nome}}</td>
								<td>{{consulta.data | date:'dd/MM/yyyy'}}</td>
								<td>{{consulta.data_revisao | date:'dd/MM/yyyy'}}</td>
								<td>
									<div ng-if=consulta.acompanhamento>
										<input type='checkbox' checked>
									<div>
									<div ng-if= (consulta.acompanhamento == 'false')>
										<input type='checkbox'>
									<div>

								</td>
							</tr>
							<tbody>
							</tbody>
			   		</table>
				</div>
			</div>
		</div class="col-md-12">
	</div>
	</br>
	<div class="row">
		<div class="col-md-4">
	  			<button type="submit" class="btn btn-default" ng-click="nova_consulta()">Nova Consulta</button>
	  	</div>
	</div>
</div>
<script>
var app = angular.module('consultas',[]);
//var consultasList = [1,2,3,5];
//var dateFormat = require('dateformat');
app.controller('consultasController', function($scope,$http,$filter){
	
	$scope.consultaList = [];
	$scope.nova_consulta = function(){
		console.log("Nova Consulta");
		location.assign("http://localhost:1337/nova_consulta")
		console.log("OK");
				
	};

	init = function(){
		$http.get('/get_consultas')
		.success(function(data, status, headers, config){
			console.log(data);
			console.log(data[0]);
			var paciente = data[0].paciente ;
			console.log(paciente.nome);
			$scope.consultaList = data;
		})
		.error(function(data, status, headers, config) {
			console.log(data);

		});
	};

	init();

});

</script>